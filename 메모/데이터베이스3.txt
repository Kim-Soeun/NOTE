< SQL 데이터 조작문 >

1. SELECT문( 데이터 검색 )


  + 데이터베이스2 참고


** 집계 함수 검색 **

- COUNT(열_이름) : 특정 열 값의 개수 또는 행의 개수
- MAX(열_이름) : 특정 열 값 중에서 최댓값
- MIN(열_이름) : 특정 열 값 중에서 최소값
- SUM(열_이름) : 특정 열 값의 합계
- AVG(열_이름) : 특정 열 값의 평균



- AS(별칭이름) : 검색 결과 반환되는 열에 대한 별칭을 정의하는 키워드, 생략 가능
 
  ex) select count(주소) as 학생수 from 학생;
      -- 학생 테이블에서 주소의 개수를 학생수로 바꿔서 출력 


- GROUP BY(그룹화 검색) : 집계함수와 함계 사용, 그룹으로 묶어주는 역할
  
  ex)  group by 지역  -- 지역별 매물의 개수
                         

- HAVING : group by 통해 생성된 그룹 중 특정 조건 만족하는 그룹만 검색 

  ex) select 학년,count(*) as '학년별 학생수' from 학생 GROUP BY 학년 HAVING count(*)>=2;
     -- 각 학년별로 2명 이상의 학생을 갖는 학년에 대해서만 학생수를 검색


- LIKE(문자 연산자 검색) : 문자열에서 부분적으로 일치하는 값을 찾을 때 사용

  ex) select 학번, 이름 from 학생 where 이름 like '이__';
     -- 이씨 성을 가진 학생들의 학번과 이름 검색

  ex) select 이름 from 학생 where 주소 like '%서울%'
     -- 주소지가 서울인 학생의 이름 검색
  

  + 추가 설명

   like '_라면' -- 라면으로 끝나는 3글자   ex) 열라면, 진라면, 신라면
   like '%강%'  -- 강이 포함된 데이터      ex) 강, 강물, 영산강
   like '강%'   -- 처음이 강으로 시작하는 데이터  ex) 강강술레
   like '%강'   -- 끝이 강으로 끝나는 데이터      ex) 생강


- IS NULL, IS NOT NULL(널 값 검색) 

  - null : 아직 지정되지 않은 값
  - IS NULL : 속성의 값이 널 값인지 비교할 때 사용
  ex) select 이름, 휴대폰번호 from 학생 where 휴대폰번호 is null;
   -- 휴대폰번호가 등록되지 않은(널 값을 갖는) 학생의 이름과 휴대폰번호를 검색 

  - IS NOT NULL : 널 값이 아닌지를 비교할 때 사용
  ex) select 이름 from 학생 where 휴대폰번호 is not null and 소속학과='컴퓨터';
   -- 학생 테이블에서 연락처가 비어 있지 않은 학생들의 이름을 검색하되 소속학과가 컴퓨터인 학생들만 검색


- UNION(집합 연산자 이용한 검색) : 검색결과 결합(합집합)

  ex) select 학번 from 학생 where 성별='여' UNION select 학번 from 수강 where 평가학점='A';
   -- 여학생이거나 A학점 받은 학생의 학번을 검색



- 부 질의문 : 질의문 안에 중첩되어 포함된 또 다른 SELECT 검색문
              괄호 안의 가장 안쪽 부 질의문부터 먼저 수행하고 가장 바깥쪽 주 질의문이 가장 나중에 수행

  - IN 연산자 : 괄호 안에 나열된 값들 중에서 하나라도 일치하는 경우 참을 반환하는 연산자
    
    ex) select 이름 from 학생 where 학번 in("s001", "s003", "s004"); -- in 연산자
        select 이름 from 학생 where 학번 in (select 학번 from 수강 where 과목번호='c002');  -- 부 질의문
     -- 과목번호가 c002인 과목을 수강한 학생의 이름을 검색

    ex) select 학번 from 대학생 where 성별='F' and 학번 in(select 학번 from 시험 where 국어>=90);
     -- 성별이 여자이면서 국어점수가 90점 이상인 학생의 학번을 검색하세요

 - 중첩 부 질의문

   ex) select 이름 from 학생 where 학번 in (select 학번 from 수강 where 과목번호 in
       (select 과목번호 from 과목 where 이름='정보보호'));
     -- '정보보호' 과목을 수강한 학생의 이름을 검색 
     -- in : 결과가 여러개일 때 사용
     -- = : 결과가 하나일 때 사용


  - EXISTS 연산자 : 실행결과로 반환되는 행이 존재하는지 존재 유무 확인하는 연산자

    ex) select 이름 from 학생 where EXISTS (select * from 수강 where 수강.학번 and 과목번호='c002');
     -- 과목번호가 'c002'인 과목을 수강한 학생의 이름을 검색(EXISTS 연산자)

  - JOIN 조인 검색 : 검색시 참조해야 할 테이블이 여러 개일 때 조인 조건을 사용하여 검색문 작성
   
    ex)  select * from 학생 join 수강 on 학생.학번=수강.학번;
     -- 전체 학생의 기본 정보와 모든 수강 정보를 검색(동등 조인)

    ex) select 학생.학번,학생.이름,수강.과목번호 from (학생 join 수강 on 학생.학번=수강.학번)
        join 과목 on 수강.과목번호=과목.과목번호 where 과목.이름='정보보호';
     -- 학생 중에서 '정보보호' 과목을 수강한 학생의 학번과 이름, 과목번호를 검색(테이블 3개 조인)
 
  - 테이블 별칭 사용
    
     ex) select 이름,과목번호 from 학생 as S, 수강 as E where S.학번=E.학번 and 과목번호='c002';
     -- 학생 중에서 과목번호가 'c002'인 과목을 수강한 학생의 이름, 과목번호를 검색

  - 외부 조인 : 조인 대상 테이블의 모든 행들이 결과에 포함되기를 원하는 경우 사용
    
     ex) select 학생.학번,이름,평가학점 from 학생 left outer join 수강 on 학생.학번=수강.학번;
     -- 과목을 수강하지 않은 학생을 포함하여 모든 학생의 학번, 이름과 학생이 수강한 교과의 평가학점을 검색
